<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="WireGuard Router Configuration Tool - Generate VPN configs for multiple platforms">
    <title>WireGuard Config Generator</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/modal.css">
</head>
<body>
    <div class="app-container">
        <aside class="sidebar">
            <div class="logo" style="position: relative;">
                <h1>WireGuard Config</h1>
                <button class="help-button" onclick="KeyboardShortcuts.showHelp()" title="Keyboard Shortcuts (?)">?</button>
            </div>
            <nav class="nav">
                <button class="nav-item active" data-view="server" data-i18n="nav.server">Server</button>
                <button class="nav-item" data-view="clients" data-i18n="nav.clients">Clients</button>
                <button class="nav-item" data-view="site-to-site" data-i18n="nav.siteToSite">Site-to-Site</button>
                <button class="nav-item" data-view="export" data-i18n="nav.export">Export</button>
                <button class="nav-item" data-view="profiles" data-i18n="nav.profiles">Profiles</button>
                <button class="nav-item" data-view="settings" data-i18n="nav.settings">Settings</button>
            </nav>
        </aside>

        <main class="main-content">
            <div class="view active" id="view-server">
                <h2 data-i18n="server.title">Server Configuration</h2>
                <div class="config-section">
                    <div class="form-group">
                        <label for="server-name" data-i18n="server.name">Server Name</label>
                        <input type="text" id="server-name" placeholder="My VPN Server" value="VPN Server">
                    </div>

                    <div class="form-group">
                        <label for="listen-port">Listen Port</label>
                        <input type="number" id="listen-port" min="1" max="65535" value="51820">
                    </div>

                    <div class="form-group">
                        <label>Network Configuration</label>
                        <div class="network-config">
                            <input type="text" id="base-network" placeholder="10.50.0.0" value="10.50.0.0">
                            <select id="connection-count">
                                <option value="6">1-6 connections (/29)</option>
                                <option value="14">7-14 connections (/28)</option>
                                <option value="30" selected>15-30 connections (/27)</option>
                                <option value="62">31-62 connections (/26)</option>
                                <option value="126">63-126 connections (/25)</option>
                                <option value="254">127-254 connections (/24)</option>
                            </select>
                        </div>
                        <div class="subnet-info" id="subnet-info">
                            Subnet: <span id="calculated-subnet">10.50.0.0/27</span> - <span id="usable-ips">30</span> usable IPs
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="server-dns">DNS Servers</label>
                        <input type="text" id="server-dns" placeholder="1.1.1.1, 1.0.0.1" value="1.1.1.1, 1.0.0.1">
                    </div>

                    <div class="form-group">
                        <label for="mtu">MTU</label>
                        <input type="number" id="mtu" min="1280" max="1500" value="1420">
                    </div>

                    <div class="form-group">
                        <label for="endpoint">Endpoint (Hostname/IP)</label>
                        <input type="text" id="endpoint" placeholder="vpn.example.com or IPv64.net domain">
                    </div>

                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="enable-psk" checked>
                            Enable Pre-Shared Key (PSK)
                        </label>
                    </div>

                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="enable-nat" checked>
                            Enable NAT/Masquerade
                        </label>
                    </div>

                    <div class="form-group">
                        <label for="keepalive">Default Keepalive (seconds)</label>
                        <input type="number" id="keepalive" min="0" max="300" value="25">
                    </div>

                    <div class="key-section">
                        <h3>Server Keys</h3>
                        <button class="btn btn-primary" id="generate-server-keys">Generate Keys</button>
                        <div class="key-display" id="server-keys-display" style="display: none;">
                            <div class="form-group">
                                <label>Private Key</label>
                                <input type="password" id="server-private-key" readonly>
                            </div>
                            <div class="form-group">
                                <label>Public Key</label>
                                <input type="text" id="server-public-key" readonly>
                            </div>
                        </div>
                    </div>

                    <div class="key-section">
                        <h3>Dynamic DNS (Optional)</h3>
                        <div class="form-group">
                            <label>
                                <input type="checkbox" id="enable-dyndns">
                                Enable IPv64.net DynDNS
                            </label>
                        </div>
                        <div id="dyndns-config" style="display: none;">
                            <div class="form-group">
                                <label for="dyndns-domain">Domain (*.ipv64.net)</label>
                                <input type="text" id="dyndns-domain" placeholder="yourdomain.ipv64.net">
                            </div>
                            <div class="form-group">
                                <label for="dyndns-apikey">API Update Key</label>
                                <input type="password" id="dyndns-apikey" placeholder="Your IPv64.net update key">
                                <small style="color: var(--text-secondary); display: block; margin-top: 0.5rem;">
                                    ⚠️ API key will be stored in browser localStorage
                                </small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="view" id="view-clients">
                <div class="view-header">
                    <h2 data-i18n="clients.title">Client Management</h2>
                    <div class="header-actions">
                        <button class="btn btn-primary" id="add-client" data-i18n="clients.add">Add Client</button>
                        <button class="btn btn-secondary" id="bulk-generate" data-i18n="clients.bulkGenerate">Bulk Generate</button>
                    </div>
                </div>
                <div class="clients-list" id="clients-list">
                    <div class="empty-state">
                        <p>No clients configured. Click "Add Client" to get started.</p>
                    </div>
                </div>
            </div>

            <div class="view" id="view-site-to-site">
                <h2 data-i18n="s2s.title">Site-to-Site Configuration</h2>
                <div class="config-section">
                    <div class="s2s-header">
                        <p style="color: var(--text-secondary); margin-bottom: 2rem;">
                            Configure WireGuard tunnel between two sites (offices, networks, etc.)
                        </p>
                    </div>

                    <div class="s2s-sites">
                        <div class="s2s-site">
                            <h3>Site A</h3>
                            <div class="form-group">
                                <label for="s2s-site-a-name">Site Name</label>
                                <input type="text" id="s2s-site-a-name" placeholder="Main Office" value="Site A">
                            </div>
                            <div class="form-group">
                                <label for="s2s-site-a-lan">Local LAN Network (CIDR)</label>
                                <input type="text" id="s2s-site-a-lan" placeholder="192.168.1.0/24" value="192.168.1.0/24">
                                <small style="color: var(--text-secondary); display: block; margin-top: 0.25rem;">
                                    Local network behind this site
                                </small>
                            </div>
                            <div class="form-group">
                                <label for="s2s-site-a-tunnel-ip">WireGuard Tunnel IP</label>
                                <input type="text" id="s2s-site-a-tunnel-ip" placeholder="10.99.0.1" value="10.99.0.1">
                            </div>
                            <div class="form-group">
                                <label for="s2s-site-a-endpoint">Public Endpoint (IP or Domain)</label>
                                <input type="text" id="s2s-site-a-endpoint" placeholder="site-a.example.com">
                            </div>
                            <div class="form-group">
                                <label for="s2s-site-a-port">Listen Port</label>
                                <input type="number" id="s2s-site-a-port" value="51820" min="1" max="65535">
                            </div>
                            <div class="form-group">
                                <button class="btn btn-primary" id="s2s-generate-keys-a">Generate Keys</button>
                            </div>
                            <div class="s2s-keys" id="s2s-keys-a" style="display: none;">
                                <div class="form-group">
                                    <label>Private Key</label>
                                    <input type="password" id="s2s-site-a-private" readonly>
                                </div>
                                <div class="form-group">
                                    <label>Public Key</label>
                                    <input type="text" id="s2s-site-a-public" readonly>
                                </div>
                            </div>
                        </div>

                        <div class="s2s-divider">
                            <div class="s2s-arrow">⟷</div>
                        </div>

                        <div class="s2s-site">
                            <h3>Site B</h3>
                            <div class="form-group">
                                <label for="s2s-site-b-name">Site Name</label>
                                <input type="text" id="s2s-site-b-name" placeholder="Branch Office" value="Site B">
                            </div>
                            <div class="form-group">
                                <label for="s2s-site-b-lan">Local LAN Network (CIDR)</label>
                                <input type="text" id="s2s-site-b-lan" placeholder="192.168.2.0/24" value="192.168.2.0/24">
                                <small style="color: var(--text-secondary); display: block; margin-top: 0.25rem;">
                                    Local network behind this site
                                </small>
                            </div>
                            <div class="form-group">
                                <label for="s2s-site-b-tunnel-ip">WireGuard Tunnel IP</label>
                                <input type="text" id="s2s-site-b-tunnel-ip" placeholder="10.99.0.2" value="10.99.0.2">
                            </div>
                            <div class="form-group">
                                <label for="s2s-site-b-endpoint">Public Endpoint (IP or Domain)</label>
                                <input type="text" id="s2s-site-b-endpoint" placeholder="site-b.example.com">
                            </div>
                            <div class="form-group">
                                <label for="s2s-site-b-port">Listen Port</label>
                                <input type="number" id="s2s-site-b-port" value="51820" min="1" max="65535">
                            </div>
                            <div class="form-group">
                                <button class="btn btn-primary" id="s2s-generate-keys-b">Generate Keys</button>
                            </div>
                            <div class="s2s-keys" id="s2s-keys-b" style="display: none;">
                                <div class="form-group">
                                    <label>Private Key</label>
                                    <input type="password" id="s2s-site-b-private" readonly>
                                </div>
                                <div class="form-group">
                                    <label>Public Key</label>
                                    <input type="text" id="s2s-site-b-public" readonly>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="s2s-actions">
                        <button class="btn btn-primary" id="s2s-generate-configs">Generate Configurations</button>
                        <button class="btn btn-secondary" id="s2s-swap-sites">Swap Sites</button>
                    </div>

                    <div class="s2s-output" id="s2s-output" style="display: none;">
                        <h3>Generated Configurations</h3>
                        <div class="s2s-config-output">
                            <div class="s2s-config-item">
                                <h4 id="s2s-config-a-title">Site A Configuration</h4>
                                <pre><code id="s2s-config-a"></code></pre>
                                <button class="btn btn-secondary btn-sm" id="s2s-download-a">Download</button>
                            </div>
                            <div class="s2s-config-item">
                                <h4 id="s2s-config-b-title">Site B Configuration</h4>
                                <pre><code id="s2s-config-b"></code></pre>
                                <button class="btn btn-secondary btn-sm" id="s2s-download-b">Download</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="view" id="view-export">
                <h2 data-i18n="export.title">Export Configurations</h2>
                <div class="export-options">
                    <div class="form-group">
                        <label for="export-platform">Target Platform</label>
                        <select id="export-platform">
                            <option value="standard">WireGuard Standard (.conf)</option>
                            <option value="mikrotik">MikroTik RouterOS (.rsc)</option>
                            <option value="vyos">VyOS (commands)</option>
                            <option value="opnsense">OPNsense (guide)</option>
                            <option value="fritzbox">Fritz!Box (.conf)</option>
                            <option value="teltonika">Teltonika RUT (guide)</option>
                            <option value="edgerouter">EdgeRouter (commands)</option>
                            <option value="glinet">GL.iNet (.conf)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="export-type">Export Type</label>
                        <select id="export-type">
                            <option value="server">Server Configuration Only</option>
                            <option value="all-clients">All Client Configurations</option>
                            <option value="complete">Complete Setup (Server + All Clients)</option>
                        </select>
                    </div>
                    <div class="export-actions">
                        <button class="btn btn-primary" id="export-preview">Preview</button>
                        <button class="btn btn-secondary" id="export-download">Download</button>
                        <button class="btn btn-secondary" id="export-zip">Download as ZIP</button>
                    </div>
                </div>
                <div class="export-preview" id="export-preview-area">
                    <pre><code id="export-code"></code></pre>
                </div>
            </div>

            <div class="view" id="view-profiles">
                <div class="view-header">
                    <h2 data-i18n="profiles.title">Profiles</h2>
                    <div class="header-actions">
                        <button class="btn btn-primary" id="new-profile" data-i18n="profiles.new">New Profile</button>
                        <button class="btn btn-secondary" id="import-profile" data-i18n="profiles.import">Import</button>
                    </div>
                </div>
                <div class="profiles-list" id="profiles-list">
                    <div class="empty-state">
                        <p>No saved profiles. Your current configuration will be auto-saved.</p>
                    </div>
                </div>
            </div>

            <div class="view" id="view-settings">
                <h2 data-i18n="settings.title">Settings</h2>
                <div class="settings-section">
                    <div class="form-group">
                        <label data-i18n="settings.theme">Theme</label>
                        <select id="theme-select">
                            <option value="system">System Default</option>
                            <option value="light">Light</option>
                            <option value="dark">Dark</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label data-i18n="settings.language">Language</label>
                        <select id="language-select">
                            <option value="en">English</option>
                            <option value="de">Deutsch</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Configuration Validation</label>
                        <button class="btn btn-primary" id="validate-config" data-i18n="settings.validate">Validate Configuration</button>
                        <p style="color: var(--text-secondary); font-size: 0.9rem; margin-top: 0.5rem;">Check for configuration errors before exporting</p>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script src="lib/tweetnacl.min.js"></script>
    <script src="lib/qrcode.min.js"></script>
    <script src="lib/jszip.min.js"></script>
    <script src="lib/FileSaver.min.js"></script>

    <script src="js/i18n.js"></script>
    <script src="js/crypto.js"></script>
    <script src="js/validation.js"></script>
    <script src="js/ip-manager.js"></script>
    <script src="js/config-generator.js"></script>
    <script src="js/profile-manager.js"></script>
    <script src="js/profile-ui.js"></script>
    <script src="js/qr-generator.js"></script>
    <script src="js/site-to-site.js"></script>
    <script src="js/dyndns/ipv64.js"></script>

    <script src="js/export/standard.js"></script>
    <script src="js/export/mikrotik.js"></script>
    <script src="js/export/vyos.js"></script>
    <script src="js/export/fritzbox.js"></script>
    <script src="js/export/opnsense.js"></script>
    <script src="js/export/edgerouter.js"></script>
    <script src="js/export/glinet.js"></script>
    <script src="js/export/teltonika.js"></script>

    <script src="js/shortcuts.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
